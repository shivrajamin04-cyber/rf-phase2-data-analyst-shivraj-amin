import pandas as pd

# Load dataset
df = pd.read_csv("movies.csv")

# Show columns
print("Columns in file:", list(df.columns))

# Remove duplicates
df = df.drop_duplicates()

# Clean column names
df.columns = df.columns.str.lower().str.replace(" ", "_")

# Convert rating if it exists
if "rating" in df.columns:
    df["rating"] = pd.to_numeric(df["rating"], errors="coerce")
    df["rating"] = df["rating"].fillna(df["rating"].mean())

# Convert year if it exists
if "year" in df.columns:
    df["year"] = pd.to_numeric(df["year"], errors="coerce")
    df["year"] = df["year"].fillna(df["year"].median()).astype(int)

# Fill genre only if it exists
if "genre" in df.columns:
    df["genre"] = df["genre"].fillna("Unknown")

# Remove rows with no title (if column exists)
if "title" in df.columns:
    df = df.dropna(subset=["title"])

# Sort by rating if exists
if "rating" in df.columns:
    df = df.sort_values(by="rating", ascending=False)

# Save cleaned data
df.to_csv("clean_movies.csv", index=False)

print("Data cleaned and saved as clean_movies.csv")
